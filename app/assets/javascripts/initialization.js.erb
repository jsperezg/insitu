if (typeof jQuery !== 'undefined') {
  $(document).on("page:change", function () {
    var dateInputs = $("input.date"),
        documentIds = $(".document-id"),
        locale = document.documentElement.lang,
        dateFormat = "yyyy-mm-dd",
        bestInPlace = $(".best_in_place"),
        pullDownElements = $('.pull-down');

    /* Activating Best In Place */
    if (bestInPlace.length) {
      bestInPlace.best_in_place();

      jQuery(document).on('best_in_place:error', function (event, request, error) {
        'use strict';
        // Display all error messages from server side validation
        jQuery.each(jQuery.parseJSON(request.responseText), function (index, value) {
          var container = jQuery('#bip_error_message');

          if (typeof value === "object") {value = index + " " + value.toString(); }

          container.html(value);
          container.show();
          window.setTimeout(function() { container.hide(); }, 2000);
        });
      });
    }

    //  date input.
    if (dateInputs.length) {
      switch (locale) {
        case "es":
          dateFormat = "dd/mm/yyyy";
          break;
      }

      dateInputs.inputmask(dateFormat);
    }

    if (documentIds.length) {
      documentIds.inputmask("A{1,3}/9999/999999");
    }

    // Pulldown elements.
    pullDownElements.each(function () {
      var margin = $(this).parent().height()- $(this).outerHeight(true);

      if (margin < 0) {
        margin = 0;
      }

      $(this).css('margin-top', margin);
    });
  });
}
